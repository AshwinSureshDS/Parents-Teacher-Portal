<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Tiny Wonders - Student Portal</title>
    <link
      href="https://fonts.googleapis.com/css2?family=Reem+Kufi+Fun:wght@400;700&display=swap"
      rel="stylesheet"
    />
    <style>
      /* Update these styles to remove browser scrollbar */
      html,
      body {
        height: 100%;
        overflow: hidden; /* Prevent browser scrolling */
        scrollbar-width: none; /* Firefox */
        -ms-overflow-style: none; /* IE and Edge */
      }

      /* Hide browser scrollbar for Chrome, Safari and Opera */
      html::-webkit-scrollbar,
      body::-webkit-scrollbar {
        display: none;
      }

      /* Ensure content sections don't show browser scrollbar */
      .content-section {
        scrollbar-width: none; /* Firefox */
        -ms-overflow-style: none; /* IE and Edge */
      }

      .content-section::-webkit-scrollbar {
        display: none;
      }

      /* Keep the custom scrollbar for blackboard content */
      .blackboard-content-wrapper {
        flex: 1;
        overflow-y: auto;
        padding-right: 10px;
        max-height: 280px;
      }

      /* When in creation mode, the wrapper should not scroll */
      #noticeCreationView.blackboard-content-wrapper {
        overflow: visible;
        max-height: none;
      }

      /* Add styling for the scrollbar */
      .blackboard-content-wrapper::-webkit-scrollbar {
        width: 8px;
        display: block; /* Ensure scrollbar is visible */
      }

      .blackboard-content-wrapper::-webkit-scrollbar-track {
        background: rgba(255, 255, 255, 0.1);
        border-radius: 4px;
      }

      .blackboard-content-wrapper::-webkit-scrollbar-thumb {
        background: rgba(255, 255, 255, 0.3);
        border-radius: 4px;
      }

      .blackboard-content-wrapper::-webkit-scrollbar-thumb:hover {
        background: rgba(255, 255, 255, 0.5);
      }

      body {
        margin: 0;
        padding: 0;
        font-family: "Reem Kufi Fun", Arial, sans-serif;
        background-color: #4a4f55; /* Dark slate color as fallback */
        background-image: url("static/images/office-desk-table-with-pencils-supplies.jpg");
        background-size: cover;
        background-position: center;
        background-attachment: fixed;
        height: 100%;
        overflow: hidden; /* Add this to prevent body scrolling */
      }

      .container {
        max-width: 1200px;
        margin: 0 auto;
        padding: 10px;
        position: relative;
        overflow: hidden; /* Change from overflow-x: hidden to overflow: hidden */
        height: calc(100% - 20px); /* Add height calculation */
      }

      .header {
        text-align: center;
        margin-bottom: 10px;
      }

      .logo {
        display: flex;
        align-items: center;
        justify-content: center;
        margin-bottom: 10px;
      }

      .logo img {
        height: 70px;
        border-radius: 25px; /* Add rounded corners */
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2); /* Optional: adds subtle shadow */
      }

      .nav-bar {
        background-color: white;
        border-radius: 25px;
        padding: 10px 20px;
        display: flex;
        justify-content: space-between;
        box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
        border: 1px solid black;
        position: relative;
      }

      .nav-item {
        display: flex;
        align-items: center;
        color: #888;
        text-decoration: none;
        padding: 8px 15px;
        cursor: pointer;
        transition: color 0.3s ease, filter 0.3s ease, opacity 0.3s ease;
        position: relative;
        z-index: 2;
      }

      .nav-item.active {
        color: black;
        font-weight: bold;
      }

      .nav-item:hover {
        color: #555;
      }

      .nav-item img {
        width: 20px;
        margin-right: 8px;
        filter: grayscale(100%);
        opacity: 0.6;
        transition: filter 0.3s ease, opacity 0.3s ease;
      }

      .nav-item.active img {
        filter: grayscale(0%);
        opacity: 1;
        filter: brightness(0);
      }

      .nav-item:hover img {
        opacity: 0.8;
      }

      .slider {
        position: absolute;
        bottom: 0;
        height: 3px;
        background-color: #000000;
        transition: all 0.3s ease;
        z-index: 1;
      }

      /* Content Sections */
      .content-section {
        display: none;
        animation-duration: 0.5s;
        animation-fill-mode: both;
        width: 100%;
        position: absolute;
        opacity: 0;
        pointer-events: none;
        overflow: hidden; /* Ensure all sections have hidden overflow */
        height: calc(100% - 100px); /* Adjust based on header height */
      }

      .content-section.active {
        display: block;
        position: relative;
        opacity: 1;
        pointer-events: auto;
        overflow: hidden;
      }

      @keyframes slideInFromRight {
        0% {
          transform: translateX(100%);
        }
        100% {
          transform: translateX(0);
        }
      }

      @keyframes slideInFromLeft {
        0% {
          transform: translateX(-100%);
        }
        100% {
          transform: translateX(0);
        }
      }

      @keyframes slideOutToLeft {
        0% {
          transform: translateX(0);
        }
        100% {
          transform: translateX(-100%);
        }
      }

      @keyframes slideOutToRight {
        0% {
          transform: translateX(0);
        }
        100% {
          transform: translateX(100%);
        }
      }

      .slide-in-right {
        animation-name: slideInFromRight;
      }

      .slide-in-left {
        animation-name: slideInFromLeft;
      }

      .slide-out-left {
        animation-name: slideOutToLeft;
      }

      .slide-out-right {
        animation-name: slideOutToRight;
      }

      /* Home Section with Single Overlay */
      #home {
        overflow: hidden !important;
        height: auto !important;
        max-height: calc(100vh - 180px) !important;
        padding-bottom: 20px;
        position: relative !important;
        z-index: 1;
      }

      #home::before {
        content: "";
        position: absolute;
        top: 10px; /* Change from 20px to 10px */
        left: 50%;
        transform: translateX(-50%);
        width: 65%;
        height: calc(
          100% - 20px
        ); /* Change from calc(100% - 40px) to calc(100% - 20px) */
        background-image: url("static/images/Screenshot 2025-03-09 165937.png"); /* Use the provided image */
        background-size: cover;
        background-position: center;
        z-index: -1;
        box-shadow: 0 0 40px 40px rgba(255, 255, 255, 0) inset; /* Change to transparent */
        filter: blur(20px); /* Add blur effect */
      }

      /* Reset profile section - remove overlay */
      .profile-section {
        display: flex;
        flex-direction: row;
        align-items: center;
        justify-content: center;
        margin-top: 20px;
        margin-bottom: 20px;
        position: relative;
      }

      /* Reset contact section - remove overlay */
      .contact-section {
        width: 100%;
        max-width: 600px;
        margin: 0 auto;
        padding-bottom: 20px;
        overflow: hidden;
        position: relative;
        z-index: 2;
      }

      .profile-pic {
        width: 100px;
        height: 100px;
        background-color: #ffffff;
        border-radius: 50%;
        display: flex;
        justify-content: center;
        align-items: center;
        margin-right: 20px;
      }

      .profile-pic img {
        width: 60px;
      }

      .profile-info {
        display: flex;
        flex-direction: column;
        align-items: flex-start;
      }

      .profile-name {
        font-size: 28px;
        font-weight: bold;
        margin-bottom: 5px;
        text-align: left;
        color: white;
      }

      .student-id {
        font-size: 18px;
        color: rgba(255, 255, 255, 0.8);
        margin-bottom: 0;
        text-align: left;
      }

      .contact-header {
        font-weight: bold;
        border-bottom: 1px solid white;
        padding-bottom: 3px;
        margin-bottom: 10px;
        font-size: 16px;
        color: white;
      }

      .contact-info {
        margin-bottom: 20px;
      }

      .contact-row {
        display: flex;
        margin-bottom: 8px;
      }

      .contact-label {
        font-weight: bold;
        width: 180px;
        font-size: 14px;
        color: rgba(255, 255, 255, 0.9);
      }

      .contact-value {
        flex: 1;
        font-size: 14px;
        color: rgba(255, 255, 255, 0.8);
      }

      /* Communications Section Styles */
      .chat-container {
        display: flex;
        height: 450px;
        border-radius: 20px;
        overflow: hidden;
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        background-color: white;
        margin: 20px auto;
        max-width: 1100px;
      }

      .contacts-panel {
        width: 320px;
        background-color: #f0f0f0;
        border-right: 1px solid #ddd;
        display: flex;
        flex-direction: column;
      }

      .contacts-header {
        padding: 15px;
        border-bottom: 1px solid #ddd;
      }

      .contacts-header h3 {
        margin: 0;
        font-size: 18px;
        font-weight: bold;
        text-transform: uppercase;
        border-bottom: 2px solid #000;
        padding-bottom: 5px;
        display: inline-block;
      }

      .contacts-list {
        flex: 1;
        overflow-y: auto;
      }

      .contact {
        display: flex;
        padding: 15px;
        border-bottom: 1px solid #ddd;
        cursor: pointer;
        align-items: center;
      }

      .contact:hover {
        background-color: #e8e8e8;
      }

      .contact.active {
        background-color: #e0e0e0;
      }

      .contact-avatar {
        width: 50px;
        height: 50px;
        border-radius: 50%;
        background-color: #ccc;
        margin-right: 15px;
        flex-shrink: 0;
      }

      .contact-info {
        flex: 1;
        min-width: 0;
      }

      .contact-name {
        font-weight: bold;
        margin-bottom: 5px;
      }

      .contact-preview {
        color: #666;
        white-space: nowrap;
        overflow: hidden;
        text-overflow: ellipsis;
        font-size: 14px;
        display: flex;
        align-items: center;
      }

      .contact-preview::before {
        content: "";
        display: inline-block;
        width: 14px;
        height: 14px;
        background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="%234285f4"><path d="M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41L9 16.17z"/></svg>');
        background-size: contain;
        margin-right: 5px;
        flex-shrink: 0;
      }

      .contact-time {
        color: #666;
        font-size: 12px;
        white-space: nowrap;
        margin-left: 10px;
      }

      .chat-panel {
        flex: 1;
        display: flex;
        flex-direction: column;
        background-color: white;
      }

      .chat-header {
        padding: 15px;
        border-bottom: 1px solid #ddd;
        display: flex;
        align-items: center;
      }

      .chat-header-avatar {
        width: 40px;
        height: 40px;
        border-radius: 50%;
        background-color: #ccc;
        margin-right: 15px;
      }

      .chat-header-name {
        font-weight: bold;
        font-size: 18px;
      }

      .chat-messages {
        flex: 1;
        padding: 15px;
        overflow: hidden;
        display: flex;
        flex-direction: column;
      }

      .chat-message {
        padding: 10px 15px;
        border-radius: 15px;
        margin-bottom: 10px;
        max-width: 70%;
        word-wrap: break-word;
      }

      .received-message {
        background-color: #f0f0f0;
        align-self: flex-start;
      }

      .sent-message {
        background-color: #dcf8c6;
        align-self: flex-end;
      }

      .message-content {
        margin: 0;
        font-size: 14px;
        line-height: 1.4;
        max-height: 80px;
        overflow: hidden;
      }

      .message-time {
        font-size: 12px;
        color: #666;
        margin-top: 5px;
        display: flex;
        align-items: center;
      }

      .sent-message .message-time {
        justify-content: flex-end;
      }

      .message-status {
        display: inline-block;
        width: 14px;
        height: 14px;
        background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="%234285f4"><path d="M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41L9 16.17z"/></svg>');
        background-size: contain;
        margin-left: 5px;
      }

      .chat-input {
        padding: 15px;
        border-top: 1px solid #ddd;
        display: flex;
      }

      .chat-input input {
        flex: 1;
        padding: 10px 15px;
        border: 1px solid #ddd;
        border-radius: 30px;
        outline: none;
      }

      .chat-input button {
        margin-left: 10px;
        padding: 10px 20px;
        background-color: #4285f4;
        color: white;
        border: none;
        border-radius: 30px;
        cursor: pointer;
      }

      .chat-input button:hover {
        background-color: #3367d6;
      }

      /* Notice Section Styles */
      .blackboard-container {
        width: 60%;
        max-width: 800px;
        margin: 20px auto;
        background-color: #007a0c;
        border: 25px solid #c76300;
        padding: 20px 30px;
        color: white;
        box-shadow: 0 8px 16px rgba(0, 0, 0, 0.2);
        position: relative;
        height: 380px;
        display: flex;
        flex-direction: column;
        /* Add these properties to create the raised border effect */
        border-style: solid;
        border-color: #c76300;
        box-shadow: 0 8px 16px rgba(0, 0, 0, 0.2),
          inset 0 0 10px rgba(0, 0, 0, 0.5);
        /* Add a subtle bevel effect to the border */
        border-image: linear-gradient(
            45deg,
            #a55200,
            #c76300,
            #e07400,
            #c76300,
            #a55200
          )
          1;
      }

      /* Notice containers list */
      .notice-list {
        display: flex;
        flex-direction: column;
        gap: 15px;
        overflow-y: auto;
        max-height: 280px;
        margin-top: 20px;
        padding-right: 10px;
        /* Restore the translucent scrollbar styling */
        scrollbar-width: none; /* Firefox */
        -ms-overflow-style: none; /* IE and Edge */
      }

      /* Restore the original translucent scrollbar styling */
      .notice-list::-webkit-scrollbar {
        width: 8px;
        display: none; /* Hide the scrollbar in the notice list */
      }

      .notice-container {
        background-color: rgba(255, 255, 255, 0.1);
        border: 1px solid rgba(255, 255, 255, 0.3);
        border-radius: 5px;
        padding: 15px;
        cursor: pointer;
        transition: background-color 0.3s ease;
        position: relative;
      }

      .notice-container:hover {
        background-color: rgba(255, 255, 255, 0.2);
      }

      .notice-header {
        display: flex;
        justify-content: space-between;
        margin-bottom: 5px;
        font-size: 14px;
        color: rgba(255, 255, 255, 0.8);
      }

      .notice-title {
        font-weight: bold;
        font-size: 16px;
        margin-bottom: 5px;
      }

      .notice-preview {
        white-space: nowrap;
        overflow: hidden;
        text-overflow: ellipsis;
        font-size: 14px;
      }

      /* Delete button */
      .delete-notice-btn {
        position: absolute;
        top: 10px;
        right: 10px;
        background: none;
        border: none;
        color: rgba(255, 255, 255, 0.7);
        font-size: 18px;
        cursor: pointer;
        z-index: 10;
        transition: color 0.3s ease;
        display: none;
      }

      .notice-container:hover .delete-notice-btn {
        display: block;
      }

      .delete-notice-btn:hover {
        color: rgba(255, 0, 0, 0.7);
      }

      /* Notice creation form */
      .notice-form {
        display: flex;
        flex-direction: column;
        height: auto;
        margin-top: 20px;
      }

      .notice-title-input {
        background-color: rgba(255, 255, 255, 0.1);
        border: 1px solid rgba(255, 255, 255, 0.3);
        border-radius: 5px;
        padding: 10px;
        color: white;
        font-family: "Reem Kufi Fun", sans-serif;
        font-size: 18px;
        margin-bottom: 10px;
        outline: none;
      }

      .notice-title-input::placeholder {
        color: rgba(255, 255, 255, 0.6);
      }

      /* Modify the content input to ensure scrollbar appears above the button */
      .notice-content-input {
        background-color: rgba(255, 255, 255, 0.1);
        border: 1px solid rgba(255, 255, 255, 0.3);
        border-radius: 5px;
        padding: 10px;
        color: white;
        font-family: "Reem Kufi Fun", sans-serif;
        font-size: 16px;
        min-height: 50px;
        max-height: 150px;
        margin-bottom: 60px;
        outline: none;
        resize: none;
        overflow-y: auto;
        -ms-overflow-style: none;
        scrollbar-width: none;
      }

      .notice-content-input::placeholder {
        color: rgba(255, 255, 255, 0.6);
      }

      .notice-content-input::-webkit-scrollbar {
        width: 8px;
        display: block;
      }

      .notice-content-input::-webkit-scrollbar-track {
        background: rgba(255, 255, 255, 0.1);
        border-radius: 4px;
      }

      .notice-content-input::-webkit-scrollbar-thumb {
        background: rgba(255, 255, 255, 0.3);
        border-radius: 4px;
      }

      .notice-content-input::-webkit-scrollbar-thumb:hover {
        background: rgba(255, 255, 255, 0.5);
      }

      /* Empty state message */
      .empty-notice-message {
        text-align: center;
        margin-top: 100px;
        color: rgba(255, 255, 255, 0.7);
        font-style: italic;
      }

      /* Notice detail view */
      .notice-detail {
        display: none;
        height: 100%;
        margin-top: 20px; /* Add margin to move content down */
      }

      .notice-detail-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 15px;
      }

      .notice-detail-title {
        font-size: 18px;
        font-weight: bold;
      }

      .notice-detail-date {
        font-size: 14px;
        color: rgba(255, 255, 255, 0.8);
      }

      .notice-detail-content {
        flex: 1;
        overflow-y: auto;
        scrollbar-width: none; /* Firefox */
        -ms-overflow-style: none; /* IE and Edge */
      }

      .notice-detail-content::-webkit-scrollbar {
        display: none; /* Chrome, Safari, Opera */
      }

      /* Back button */
      .back-button {
        background: none;
        border: none;
        color: white;
        cursor: pointer;
        font-size: 16px;
        display: flex;
        align-items: center;
      }

      .back-button::before {
        content: "←";
        margin-right: 5px;
      }

      /* Create/Send Notice Button */
      .create-notice-btn {
        position: absolute;
        bottom: 20px;
        right: 20px;
        background-color: #03700e;
        color: white;
        border: 2px solid black;
        padding: 10px 15px;
        font-size: 16px;
        font-weight: bold;
        font-family: "Reem Kufi Fun", sans-serif;
        cursor: pointer;
        display: flex;
        align-items: center;
        transition: transform 0.3s ease, box-shadow 0.3s ease;
        box-shadow: 2px 2px 5px rgba(0, 0, 0, 0.2);
      }

      .create-notice-btn:hover {
        transform: translateY(-3px);
        box-shadow: 3px 5px 15px rgba(0, 0, 0, 0.5);
      }

      .create-notice-btn:active {
        transform: translateY(0);
        box-shadow: 2px 2px 5px rgba(0, 0, 0, 0.2);
      }

      .create-notice-btn::before {
        content: "+";
        font-size: 20px;
        margin-right: 8px;
      }

      .send-notice-btn {
        position: absolute;
        bottom: 20px;
        right: 20px;
        background-color: #03700e;
        color: white;
        border: 2px solid black;
        padding: 10px 15px;
        font-size: 16px;
        font-weight: bold;
        font-family: "Reem Kufi Fun", sans-serif;
        cursor: pointer;
        display: flex;
        align-items: center;
        transition: transform 0.3s ease, box-shadow 0.3s ease;
        box-shadow: 2px 2px 5px rgba(0, 0, 0, 0.2);
      }

      .send-notice-btn:hover {
        transform: translateY(-3px);
        box-shadow: 3px 5px 15px rgba(0, 0, 0, 0.5);
      }

      .send-notice-btn:active {
        transform: translateY(0);
        box-shadow: 2px 2px 5px rgba(0, 0, 0, 0.2);
      }

      .send-notice-btn::before {
        content: "→";
        font-size: 20px;
        margin-right: 8px;
      }

      /* Editable content */
      .blackboard-content[contenteditable="true"] {
        border: 1px dashed rgba(255, 255, 255, 0.3);
        padding: 5px;
        outline: none;
      }

      /* Student Report Section */
      #student-report {
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        padding: 20px;
        height: calc(100% - 120px);
        overflow: hidden;
      }

      #student-report h2,
      .student-list-title {
        font-size: 28px;
        margin-bottom: 30px;
        text-align: center;
        font-family: "Reem Kufi Fun", sans-serif;
        font-weight: bold;
      }

      #student-report p {
        text-align: center;
        max-width: 80%;
      }
      .logout-btn {
        position: fixed;
        top: 20px;
        right: 30px;
        padding: 8px 20px;
        background-color: #f5f5f5;
        color: #333;
        border: 1px solid #ddd;
        border-radius: 30px;
        cursor: pointer;
        font-family: "Reem Kufi Fun", Arial, sans-serif;
        font-weight: 500;
        box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
        z-index: 100;
        transition: background-color 0.3s ease;
        display: flex;
        align-items: center;
        gap: 6px;
      }
      .logout-btn img {
        width: 16px;
        height: 16px;
        filter: brightness(0);
        opacity: 0.7;
      }

      .logout-btn:hover {
        background-color: #e8e8e8;
      }

      .sticky-notes-container {
        display: flex;
        justify-content: space-around; /* Distribute squares evenly */
        flex-wrap: nowrap; /* Prevent wrapping, keep in one row */
        gap: 20px;
        margin-top: 70px;
        max-width: 900px; /* Limit container width if needed */
        margin-left: auto;
        margin-right: auto;
        position: relative;
        left: -20px; /* Shift container to the left */
      }

      .sticky-note-button {
        width: 200px;
        height: 200px;
        cursor: pointer;
        text-align: center;
        font-size: 28px;
        font-weight: bold;
        transition: all 0.3s ease;
        position: relative;
        display: flex;
        align-items: center;
        justify-content: center;
        padding: 10px;
        background: url("static/images/Frame 3.svg") no-repeat center center;
        background-size: contain;
        border: none;
        filter: drop-shadow(
          0px 2px 4px rgba(0, 0, 0, 0.4)
        ); /* Even darker default shadow */
        color: black;
      }

      .sticky-note-button:hover {
        transform: translateY(-15px);
        filter: drop-shadow(
          0px 15px 15px rgba(0, 0, 0, 0.8)
        ); /* Much darker hover shadow */
      }

      .sticky-note-button:active {
        transform: translateY(-5px);
        filter: drop-shadow(
          0px 5px 10px rgba(0, 0, 0, 0.6)
        ); /* Darker active shadow */
      }

      .sticky-note-button:nth-child(2) {
        /* Targets the Pre-Primary sticky note */
        padding-left: 30px; /* Shifts the text to the right */
      }

      /* Add this new section inside the student-report section */
      .report-detail-view {
        width: 90%;
        height: 100%;
        position: absolute;
        top: -60px; /* Further shifted upward from -40px */
        left: 0; /* Center horizontally instead of -20px */
        right: 0; /* Added to ensure proper centering */
        margin-left: auto; /* Added for horizontal centering */
        margin-right: auto; /* Added for horizontal centering */
        background-color: transparent;
        z-index: 10;
        padding: 20px;
        display: flex;
        flex-direction: column;
        align-items: center;
      }

      .back-nav {
        margin-top: 40px; /* Increased from 20px to move the button further down */
        margin-bottom: 10px;
        align-self: flex-start;
        margin-left: 60px;
      }

      /* Student report back button - we need a specific class to avoid conflicts with notice */
      .student-back-button {
        background: none;
        border: none;
        font-family: "Reem Kufi Fun", sans-serif;
        font-size: 25px;
        cursor: pointer;
        padding: 5px 0;
        display: flex;
        align-items: center;
      }

      .student-profile-summary {
        margin-top: -10px; /* Move upward */
        margin-bottom: 10px; /* Reduced from 20px to move content up */
        display: flex;
        justify-content: center;
        width: 100%;
      }

      .profile-image {
        width: 100px;
        height: 100px;
        border-radius: 50%;
        background-color: #222;
        display: flex;
        justify-content: center;
        align-items: center;
        margin-bottom: 10px;
      }

      .profile-image img {
        width: 60px;
      }

      .profile-details {
        text-align: center;
      }

      .profile-details h2 {
        margin: 5px 0;
        font-size: 24px;
      }

      .profile-details p {
        margin: 0;
        color: #666;
      }

      .marks-table-container {
        width: 80%;
        max-width: 800px;
        margin: 0 auto;
      }

      .marks-table {
        width: 80%;
        max-width: 800px;
        border-collapse: collapse;
        margin: 10px auto;
        box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        background-color: #ffffff;
      }

      .marks-table th,
      .marks-table td {
        padding: 4px 6px;
        text-align: center;
        border: 1px solid #333;
      }

      .marks-table th {
        background-color: #a4afd1;
        font-weight: bold;
        padding: 8px 6px;
      }

      .marks-table td {
        background-color: #db604d;
        height: 24px;
      }

      /* Table modification buttons */
      .table-controls-container {
        display: flex;
        justify-content: space-between;
        width: 80%;
        margin: 0 auto 15px auto;
      }

      .table-controls {
        display: flex;
        align-items: center;
        gap: 30px;
      }

      .table-control-group {
        display: flex;
        align-items: center;
        gap: 5px;
      }

      .table-control-label {
        font-size: 16px;
        margin-right: 8px;
        color: #333;
        font-weight: bold;
      }

      .table-btn {
        width: 30px;
        height: 30px;
        border-radius: 50%;
        border: none;
        color: white;
        font-size: 18px;
        font-weight: bold;
        cursor: pointer;
        display: flex;
        align-items: center;
        justify-content: center;
        transition: all 0.2s ease;
        opacity: 0.85;
      }

      .table-btn.add {
        background-color: rgba(66, 133, 244, 0.85);
      }

      .table-btn.add:hover {
        background-color: rgba(66, 133, 244, 1);
        opacity: 1;
      }

      .table-btn.remove {
        background-color: rgba(234, 67, 53, 0.85);
      }

      .table-btn.remove:hover {
        background-color: rgba(234, 67, 53, 1);
        opacity: 1;
      }

      /* Action buttons for marks table */
      .report-action-buttons {
        display: flex;
        justify-content: center;
        gap: 15px;
        margin-top: 20px;
        width: 80%;
      }

      .report-action-button {
        padding: 10px 30px;
        border-radius: 5px;
        font-family: "Reem Kufi Fun", sans-serif;
        font-size: 16px;
        font-weight: bold;
        cursor: pointer;
        transition: all 0.3s ease;
        border: none;
        min-width: 100px;
        opacity: 0.9;
        box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
      }

      .edit-button {
        background-color: rgba(66, 133, 244, 0.85);
        color: white;
      }

      .edit-button:hover {
        background-color: rgba(66, 133, 244, 1);
        opacity: 1;
      }

      .save-button {
        background-color: rgba(234, 67, 53, 0.85);
        color: white;
      }

      .save-button:hover {
        background-color: rgba(234, 67, 53, 1);
        opacity: 1;
      }

      .upload-button {
        background-color: rgba(234, 67, 53, 0.85);
        color: white;
      }

      .upload-button:hover {
        background-color: rgba(234, 67, 53, 1);
        opacity: 1;
      }

      .report-action-button:hover {
        transform: translateY(-2px);
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3);
      }

      /* Add this CSS for the filter dropdown */
      .notice-filter {
        position: absolute;
        top: 20px;
        right: 30px;
        z-index: 10;
      }

      .notice-filter select {
        background-color: rgba(255, 255, 255, 0.2);
        border: 1px solid rgba(255, 255, 255, 0.4);
        color: white;
        padding: 5px 10px;
        border-radius: 4px;
        font-family: "Reem Kufi Fun", sans-serif;
        font-size: 14px;
        cursor: pointer;
        outline: none;
      }

      .notice-filter select:hover {
        background-color: rgba(255, 255, 255, 0.3);
      }

      .notice-filter select option {
        background-color: #007a0c;
        color: white;
      }

      /* Update the blackboard title to make it a flex container */
      .blackboard-title {
        font-size: 24px;
        font-weight: bold;
        text-align: center;
        margin-bottom: 20px;
        position: relative;
      }

      /* Move the notice filter to the top right */
      .notice-filter {
        position: absolute;
        top: 20px;
        right: 30px; /* Changed from left to right */
        z-index: 10;
      }

      /* Add this to create a header container for both title and filter */
      .blackboard-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 20px;
        position: relative;
      }

      /* Student List Table Styles */
      .student-list-table-container {
        position: relative;
        width: 80%;
        max-width: 800px;
        margin: 0 auto;
      }

      .student-list-table {
        width: 100%;
        border-collapse: collapse;
        margin: 10px auto;
        background-color: #db604d;
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        border-radius: 5px;
      }

      .student-list-table th,
      .student-list-table td {
        padding: 8px 12px;
        text-align: left;
        border: 1px solid #333;
      }

      .student-list-table th {
        background-color: #a4afd1;
        font-weight: bold;
      }

      .student-list-table td {
        background-color: #db604d;
        height: 24px;
      }

      .student-row-container {
        position: relative;
        margin-bottom: 5px;
      }

      .circle-arrow-container {
        position: absolute;
        right: 0;
        top: 0;
        height: 100%;
        pointer-events: none;
      }

      .circle-arrow {
        position: absolute;
        right: 40px;
        display: flex;
        align-items: center;
        justify-content: center;
        width: 30px;
        height: 30px;
        background-color: #db604d;
        color: white;
        border-radius: 50%;
        cursor: pointer;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
        transition: all 0.3s ease;
        pointer-events: auto;
      }

      .circle-arrow:hover {
        background-color: #c5503f;
        transform: scale(1.1);
      }

      .student-list-actions {
        display: flex;
        justify-content: center;
        gap: 10px;
        margin: 15px 0;
      }

      .student-list-action-button {
        padding: 8px 15px;
        background-color: #e57373;
        color: white;
        border: none;
        border-radius: 4px;
        cursor: pointer;
        font-weight: bold;
        transition: background-color 0.3s;
      }

      .student-list-action-button:hover {
        background-color: #d32f2f;
      }

      .student-list-action-button.edit-button {
        background-color: #4285f4;
      }

      .student-list-action-button.save-button {
        background-color: #0f9d58;
      }

      .student-list-action-button.add-button {
        background-color: #fbbc05;
        color: #333;
      }

      /* Student Report Section Styles */
      .student-list-title {
        font-size: 28px;
        margin-bottom: 30px;
        text-align: center;
        font-family: "Reem Kufi Fun", sans-serif;
        font-weight: bold;
      }

      /* Student List Container Styles */
      .student-list-container {
        position: relative;
        padding-top: 70px;
      }

      .student-list-container .back-nav,
      .marks-detail-container .back-nav {
        position: absolute;
        top: 20px;
        left: 10px;
      }

      .student-list-title {
        margin-top: 20px;
      }

      .student-list-container .table-controls-container {
        margin-top: 20px;
      }

      /* Student List Table Styles */
      .student-list-table {
        width: 80%;
        max-width: 800px;
        border-collapse: collapse;
        margin: 10px auto;
        background-color: #db604d;
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        border-radius: 5px;
      }

      .student-list-row {
        position: relative;
        display: flex;
        align-items: center;
      }

      .student-list-table-container {
        position: relative;
        width: 80%;
        max-width: 800px;
        margin: 0 auto;
        max-height: 246px; /* 6 rows * 41px per row = 246px */
        overflow-y: auto;
        margin-bottom: 20px;
      }

      .student-list-table-container::-webkit-scrollbar {
        width: 8px;
      }

      .student-list-table-container::-webkit-scrollbar-track {
        background: #f1f1f1;
        border-radius: 4px;
      }

      .student-list-table-container::-webkit-scrollbar-thumb {
        background: #888;
        border-radius: 4px;
      }

      .student-list-table-container::-webkit-scrollbar-thumb:hover {
        background: #555;
      }

      .circle-arrows {
        position: absolute;
        right: -40px;
        display: flex;
        align-items: center;
        justify-content: center;
        width: 30px;
        height: 30px;
        background-color: #4285f4;
        color: white;
        border-radius: 50%;
        cursor: pointer;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
        transition: all 0.3s ease;
      }

      .circle-arrows:hover {
        background-color: #3367d6;
        transform: scale(1.1);
      }

      /* Marks Detail Container Styles */
      .marks-detail-container {
        position: relative;
        padding-top: 70px;
      }
    </style>
  </head>
  <body>
    <div class="container">
      <div class="header">
        <div class="logo">
          <img src="static/images/Group - Logo.jpg" alt="Tiny Wonders Logo" />
        </div>
        <div class="nav-bar">
          <a
            href="#home"
            class="nav-item active"
            data-index="0"
            onclick="switchSection(this, 'home')"
          >
            <img
              src="https://cdn-icons-png.flaticon.com/512/1946/1946436.png"
              alt="Home"
            />
            Home
          </a>
          <a
            href="#student-report"
            class="nav-item"
            data-index="1"
            onclick="switchSection(this, 'student-report')"
          >
            <img
              src="https://cdn-icons-png.flaticon.com/512/3135/3135673.png"
              alt="Student Report"
            />
            Student Report
          </a>
          <!--
                <a href="#communications" class="nav-item" data-index="2" onclick="switchSection(this, 'communications')">
                    <img src="https://cdn-icons-png.flaticon.com/512/1380/1380370.png" alt="Communications">
                    Communications
                </a>
                -->
          <a
            href="#notice"
            class="nav-item"
            data-index="3"
            onclick="switchSection(this, 'notice')"
          >
            <img
              src="https://cdn-icons-png.flaticon.com/512/1157/1157000.png"
              alt="Notice"
            />
            Notice
          </a>
          <div class="slider"></div>
        </div>
      </div>

      <!-- Home Section -->
      <div id="home" class="content-section active">
        <div class="profile-section">
          <div class="profile-pic">
            <img
              src="https://cdn-icons-png.flaticon.com/512/1077/1077114.png"
              alt="Profile"
            />
          </div>
          <div class="profile-info">
            <div class="profile-name">{{current_user[0]}}</div>
            <div class="student-id">{{current_user[1]}}</div>
          </div>
        </div>

        <div class="contact-section">
          <div class="contact-info">
            <div class="contact-header">CLASS CONTACT</div>
            <div class="contact-row">
              <div class="contact-label">
                Class Teacher: {{current_user[0]}}
              </div>
              <div class="contact-value"></div>
            </div>
            <div class="contact-row">
              <div class="contact-label">Contact:{{current_user[2]}}</div>
              <div class="contact-value"></div>
            </div>
          </div>
          <!--
                <div class="contact-info">
                    <div class="contact-header">PARENT CONTACT</div>
                    <div class="contact-row">
                        <div class="contact-label">Mother's Name:</div>
                        <div class="contact-value"></div>
                    </div>
                    <div class="contact-row">
                        <div class="contact-label">Mother's Mobile No:</div>
                        <div class="contact-value"></div>
                    </div>
                    <div class="contact-row">
                        <div class="contact-label">Father's Name:</div>
                        <div class="contact-value"></div>
                    </div>
                    <div class="contact-row">
                        <div class="contact-label">Father's Mobile No:</div>
                        <div class="contact-value"></div>
                    </div>
                    <div class="contact-row">
                        <div class="contact-label">Parent's Email:</div>
                        <div class="contact-value"></div>
                    </div>
                </div> -->
        </div>
      </div>

      <!-- Student Report Section -->
      <div id="student-report" class="content-section">
        <h2 class="student-list-title">Student Report</h2>
        <div class="sticky-notes-container">
          <div class="sticky-note-button"><span></span>Nursery</div>
          <div class="sticky-note-button"><span></span>Pre-Primary</div>
          <div class="sticky-note-button"><span></span>LKG</div>
        </div>

        <!-- Add this new section inside the student-report section -->
        <div
          id="student-report-detail"
          class="report-detail-view"
          style="display: none"
        >
          <!-- Student List View - This is the new intermediate page -->
          <div id="student-list-view" class="student-list-container">
            <div class="back-nav">
              <button
                class="student-back-button"
                onclick="showStudentReportMain()"
              >
                ← Back
              </button>
            </div>

            <h3 class="student-list-title">Student List</h3>

            <div class="table-controls-container">
              <div class="table-controls">
                <div class="table-control-group">
                  <span class="table-control-label">Rows:</span>
                  <button class="table-btn add" onclick="addStudentRow()">
                    +
                  </button>
                  <button class="table-btn remove" onclick="removeStudentRow()">
                    -
                  </button>
                </div>
              </div>
            </div>

            <div class="student-list-table-container">
              <table class="student-list-table">
                <thead>
                  <tr>
                    <th>StudentID</th>
                    <th>Name</th>
                  </tr>
                </thead>
                <tbody>
                  <tr id="student-row-1">
                    <td>STU001</td>
                    <td>John Smith</td>
                  </tr>
                  <tr id="student-row-2">
                    <td>STU002</td>
                    <td>Emma Johnson</td>
                  </tr>
                  <tr id="student-row-3">
                    <td>STU003</td>
                    <td>Michael Brown</td>
                  </tr>
                  <tr id="student-row-4">
                    <td>STU004</td>
                    <td>Sophia Davis</td>
                  </tr>
                  <tr id="student-row-5">
                    <td>STU005</td>
                    <td>William Wilson</td>
                  </tr>
                  <tr id="student-row-6">
                    <td>STU006</td>
                    <td>Olivia Martinez</td>
                  </tr>
                </tbody>
              </table>
              <div class="circle-arrow-container">
                <div
                  class="circle-arrow"
                  style="top: 58px"
                  onclick="showStudentMarksDetail('STU001', 'John Smith')"
                >
                  →
                </div>
                <div
                  class="circle-arrow"
                  style="top: 99px"
                  onclick="showStudentMarksDetail('STU002', 'Emma Johnson')"
                >
                  →
                </div>
                <div
                  class="circle-arrow"
                  style="top: 140px"
                  onclick="showStudentMarksDetail('STU003', 'Michael Brown')"
                >
                  →
                </div>
                <div
                  class="circle-arrow"
                  style="top: 181px"
                  onclick="showStudentMarksDetail('STU004', 'Sophia Davis')"
                >
                  →
                </div>
                <div
                  class="circle-arrow"
                  style="top: 222px"
                  onclick="showStudentMarksDetail('STU005', 'William Wilson')"
                >
                  →
                </div>
                <div
                  class="circle-arrow"
                  style="top: 263px"
                  onclick="showStudentMarksDetail('STU006', 'Olivia Martinez')"
                >
                  →
                </div>
              </div>
              <div class="report-action-buttons">
                <button
                  class="report-action-button edit-button"
                  onclick="editStudent()"
                >
                  Edit
                </button>
                <button
                  class="report-action-button save-button"
                  onclick="saveStudentList()"
                >
                  Save
                </button>
              </div>
            </div>
          </div>

          <!-- Student Marks Detail View - This is the existing page with subject and marks -->
          <div
            id="student-marks-view"
            class="marks-detail-container"
            style="display: none"
          >
            <div class="back-nav">
              <button
                class="student-back-button"
                onclick="showStudentListView()"
              >
                ← Back
              </button>
            </div>

            <div class="student-profile-summary">
              <div class="profile-section">
                <div class="profile-pic">
                  <img
                    src="https://cdn-icons-png.flaticon.com/512/1077/1077114.png"
                    alt="Profile"
                  />
                </div>
                <div class="profile-info">
                  <div class="profile-name" id="studentName">
                    &lt;Profile Name&gt;
                  </div>
                  <div class="student-id" id="studentId">
                    &lt;Student ID&gt;
                  </div>
                </div>
              </div>
            </div>

            <div class="marks-table-container">
              <div class="table-controls-container">
                <div class="table-controls">
                  <div class="table-control-group">
                    <span class="table-control-label">Rows:</span>
                    <button class="table-btn add" onclick="addRow()">+</button>
                    <button class="table-btn remove" onclick="removeRow()">
                      -
                    </button>
                  </div>
                  <div class="table-control-group">
                    <span class="table-control-label">Columns:</span>
                    <button class="table-btn add" onclick="addColumn()">
                      +
                    </button>
                    <button class="table-btn remove" onclick="removeColumn()">
                      -
                    </button>
                  </div>
                </div>
              </div>
              <table class="marks-table">
                <thead>
                  <tr>
                    <th>Subject</th>
                    <th>Marks</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td></td>
                    <td></td>
                  </tr>
                  <tr>
                    <td></td>
                    <td></td>
                  </tr>
                  <tr>
                    <td></td>
                    <td></td>
                  </tr>
                  <tr>
                    <td></td>
                    <td></td>
                  </tr>
                  <tr>
                    <td></td>
                    <td></td>
                  </tr>
                  <tr>
                    <td></td>
                    <td></td>
                  </tr>
                </tbody>
              </table>
              <div class="report-action-buttons">
                <button
                  class="report-action-button edit-button"
                  onclick="editMarks()"
                >
                  Edit
                </button>
                <button
                  class="report-action-button save-button"
                  onclick="saveMarks()"
                >
                  Save
                </button>
                <button
                  class="report-action-button upload-button"
                  onclick="uploadMarks()"
                >
                  Upload
                </button>
              </div>
            </div>
          </div>
        </div>
      </div>
      <!-- Communications Section 
        <div id="communications" class="content-section">
            <div class="chat-container">
                <div class="contacts-panel">
                    <div class="contacts-header">
                        <h3>CONTACTS</h3>
                    </div>
                    <div class="contacts-list">
                        <div class="contact active" onclick="setActiveContact(this)">
                            <div class="contact-avatar"></div>
                            <div class="contact-info">
                                <div class="contact-name">Teacher1</div>
                                <div class="contact-preview">Lorem Ipsum Dolor Sit Amet, C...</div>
                            </div>
                            <div class="contact-time">08:00 PM</div>
                        </div>
                        <div class="contact" onclick="setActiveContact(this)">
                            <div class="contact-avatar"></div>
                            <div class="contact-info">
                                <div class="contact-name">Teacher2</div>
                                <div class="contact-preview">Lorem Ipsum Dolor Sit Amet, C...</div>
                            </div>
                            <div class="contact-time">08:00 PM</div>
                        </div>
                        <div class="contact" onclick="setActiveContact(this)">
                            <div class="contact-avatar"></div>
                            <div class="contact-info">
                                <div class="contact-name">Teacher3</div>
                                <div class="contact-preview">Lorem Ipsum Dolor Sit Amet, C...</div>
                            </div>
                            <div class="contact-time">08:00 PM</div>
                        </div>
                        <div class="contact" onclick="setActiveContact(this)">
                            <div class="contact-avatar"></div>
                            <div class="contact-info">
                                <div class="contact-name">Teacher4</div>
                                <div class="contact-preview">Lorem Ipsum Dolor Sit Amet, C...</div>
                            </div>
                            <div class="contact-time">08:00 PM</div>
                        </div>
                    </div>
                </div>
                <div class="chat-panel">
                    <div class="chat-header">
                        <div class="chat-header-avatar"></div>
                        <div class="chat-header-name">Teacher1</div>
                    </div>
                    <div class="chat-messages">
                       
                    </div>
                    <div class="chat-input">
                        <input type="text" placeholder="Type a message..." id="messageInput" onkeypress="handleKeyPress(event)">
                        <button onclick="sendMessage()">Send</button>
                    </div>
                </div>
            </div>
        </div>
    -->

      <!-- Notice Section -->
      <div id="notice" class="content-section">
        <div
          class="blackboard-container"
          style="background-color: #007a0c; border: 25px solid #c76300"
        >
          <div class="blackboard-header">
            <div class="blackboard-title chalk-text">NOTICE</div>

            <!-- Notice Filter Dropdown - Only visible in list view -->
            <div class="notice-filter" id="noticeFilter">
              <select id="noticeFilterSelect" onchange="filterNotices()">
                <option value="all">All Notices</option>
                <option value="today">Today</option>
                <option value="week">This Week</option>
                <option value="month">This Month</option>
              </select>
            </div>
          </div>

          <!-- Notice List View -->
          <div id="noticeListView" class="blackboard-content-wrapper">
            <div id="noticeList" class="notice-list chalk-text">
              <!-- Notice containers will be added here dynamically -->
            </div>
            <div
              id="emptyNoticeMessage"
              class="empty-notice-message chalk-text"
            >
              No notices available. Click "CREATE NOTICE" to add one.
            </div>
          </div>

          <!-- Notice Creation View -->
          <div
            id="noticeCreationView"
            class="blackboard-content-wrapper"
            style="display: none"
          >
            <div class="notice-form">
              <input
                type="text"
                id="noticeTitle"
                class="notice-title-input chalk-text"
                placeholder="Enter notice title"
              />
              <div
                id="noticeContent"
                class="notice-content-input chalk-text"
                contenteditable="true"
                placeholder="Enter notice content here..."
              ></div>
            </div>
          </div>

          <!-- Notice Detail View -->
          <div id="noticeDetailView" class="notice-detail">
            <div class="notice-detail-header chalk-text">
              <button class="back-button chalk-text" onclick="showNoticeList()">
                Back
              </button>
              <div class="notice-detail-title" id="noticeDetailTitle"></div>
              <div class="notice-detail-date" id="noticeDetailDate"></div>
            </div>
            <div
              class="notice-detail-content chalk-text"
              id="noticeDetailContent"
            ></div>
          </div>

          <button
            class="create-notice-btn"
            id="noticeButton"
            onclick="toggleNoticeMode()"
          >
            CREATE NOTICE
          </button>
        </div>
      </div>
      <button class="logout-btn" onclick="window.location.href='/logout';">
        <img
          src="https://cdn-icons-png.flaticon.com/512/1828/1828479.png"
          alt="Logout"
        />
        Logout
      </button>
    </div>

    <script>
      // Initialize the slider position on page load
      document.addEventListener("DOMContentLoaded", function () {
        const activeItem = document.querySelector(".nav-item.active");
        if (activeItem) {
          positionSlider(activeItem);
        }

        // Check if there's a hash in the URL and switch to that section
        const hash = window.location.hash.substring(1);
        if (hash) {
          const navItem = document.querySelector(`a[href="#${hash}"]`);
          if (navItem) {
            switchSection(navItem, hash);
          }
        }

        // Fix scrolling behavior for notice list
        const noticeList = document.getElementById("noticeList");

        // Add wheel event listener to ensure scroll works when hovering over notices
        noticeList.addEventListener("wheel", function (e) {
          // Prevent the event from propagating to parent elements
          e.stopPropagation();

          // Calculate the new scroll position
          const scrollAmount = e.deltaY;
          noticeList.scrollTop += scrollAmount;

          // Prevent default only if we're at the top or bottom to allow page scrolling
          const isAtTop = noticeList.scrollTop === 0 && e.deltaY < 0;
          const isAtBottom =
            noticeList.scrollTop >=
              noticeList.scrollHeight - noticeList.clientHeight && e.deltaY > 0;

          if (!isAtTop && !isAtBottom) {
            e.preventDefault();
          }
        });
      });

      function positionSlider(element) {
        const slider = document.querySelector(".slider");

        // Set the width and position of the slider to match the active element
        slider.style.width = element.offsetWidth + "px";
        slider.style.left = element.offsetLeft + "px";
      }

      function switchSection(element, sectionId) {
        // Get current and target indices
        const currentIndex = parseInt(
          document.querySelector(".nav-item.active").dataset.index
        );
        const targetIndex = parseInt(element.dataset.index);

        // Determine direction of transition
        const direction = targetIndex > currentIndex ? "right" : "left";

        // Get current active section
        const currentSection = document.querySelector(
          ".content-section.active"
        );
        const targetSection = document.getElementById(sectionId);

        if (!targetSection || currentSection === targetSection) return;

        // Prevent scrolling during transition
        document.body.style.overflow = "hidden";

        // Set active state for navigation
        const navItems = document.querySelectorAll(".nav-item");
        navItems.forEach((item) => {
          item.classList.remove("active");
        });
        element.classList.add("active");
        positionSlider(element);

        // Update URL hash without scrolling
        history.pushState(null, null, `#${sectionId}`);

        // Hide all sections first
        document.querySelectorAll(".content-section").forEach((section) => {
          if (section !== currentSection) {
            section.classList.remove("active");
            section.style.display = "none";
          }
          section.classList.remove(
            "slide-out-left",
            "slide-out-right",
            "slide-in-left",
            "slide-in-right"
          );
        });

        // Apply animations
        currentSection.style.display = "block"; // Temporarily show for animation
        currentSection.classList.add(
          direction === "right" ? "slide-out-left" : "slide-out-right"
        );
        currentSection.style.animationDuration = "0.3s";

        // After current section starts sliding out
        setTimeout(() => {
          // Hide current section completely
          currentSection.style.display = "none";
          currentSection.classList.remove("active");
          currentSection.classList.remove("slide-out-left", "slide-out-right");

          // Show and animate target section
          targetSection.classList.add("active");
          targetSection.style.display = "block";
          targetSection.classList.add(
            direction === "right" ? "slide-in-right" : "slide-in-left"
          );
          targetSection.style.animationDuration = "0.3s";

          // Remove animation class after it completes
          setTimeout(() => {
            targetSection.classList.remove("slide-in-right", "slide-in-left");
            // Re-enable scrolling after animation completes
            document.body.style.overflow = "";
          }, 300);
        }, 300);
      }

      // Chat functionality
      function setActiveContact(contactElement) {
        // Remove active class from all contacts
        document.querySelectorAll(".contact").forEach((contact) => {
          contact.classList.remove("active");
        });

        // Add active class to clicked contact
        contactElement.classList.add("active");

        // Update chat header with contact name and avatar
        const contactName =
          contactElement.querySelector(".contact-name").textContent;
        document.querySelector(".chat-header-name").textContent = contactName;

        // Clear current messages
        const chatMessages = document.querySelector(".chat-messages");
        chatMessages.innerHTML = "";

        // Add appropriate messages based on selected contact
        if (contactName === "Teacher1") {
          // First message - received
          addMessage(
            "received",
            "Lorem Ipsum Dolor Sit Amet, Consectetur Adipiscing Elit, Sed Do Eiusmod Tempor Incididunt Ut Labore Et Dolore Magna Aliqua. Ut Enim Ad Minim Veniam, Quis Nostrud Exercitation Ullamco Laboris Nisi Ut Aliquip Ex Ea Commodo Consequat. Duis Aute Irure Dolor In Reprehenderit In Voluptate Velit Esse Cillum Dolore Eu Fugiat Nulla Pariatur. Excepteur Sint Occaecat Cupidatat Non Proident, Sunt In Culpa Qui Officia Deserunt Mollit Anim Id Est Laborum.",
            "08:00 PM"
          );

          // Short sent message with checkmark
          addMessage(
            "sent",
            "Lorem Ipsum Dolor Sit Amet, C...",
            "08:00 PM",
            true
          );

          // Second received message
          addMessage(
            "received",
            "Lorem Ipsum Dolor Sit Amet, Consectetur Adipiscing Elit, Sed Do Eiusmod Tempor Incididunt Ut Labore Et Dolore Magna Aliqua. Ut Enim Ad Minim Veniam, Quis Nostrud Exercitation Ullamco Laboris Nisi.",
            "08:00 PM"
          );

          // Second sent message with checkmark
          addMessage(
            "sent",
            "Lorem Ipsum Dolor Sit Amet, Consectetur Adipiscing Elit, Sed Do Eiusmod Tempor Incididunt Ut Labore Et Dolore Magna Aliqua. Ut Enim Ad Minim Veniam, Quis Nostrud Exercitation Ullamco Laboris Nisi.",
            "08:00 PM",
            true
          );
        } else if (contactName === "Teacher2") {
          addMessage(
            "received",
            "Lorem Ipsum Dolor Sit Amet, Consectetur Adipiscing Elit.",
            "08:00 PM"
          );
          addMessage(
            "sent",
            "Lorem Ipsum Dolor Sit Amet, Consectetur Adipiscing Elit.",
            "08:00 PM",
            true
          );
        } else if (contactName === "Teacher3") {
          addMessage(
            "received",
            "Lorem Ipsum Dolor Sit Amet, Consectetur Adipiscing Elit.",
            "08:00 PM"
          );
          addMessage(
            "sent",
            "Lorem Ipsum Dolor Sit Amet, Consectetur Adipiscing Elit.",
            "08:00 PM",
            true
          );
        } else if (contactName === "Teacher4") {
          addMessage(
            "received",
            "Lorem Ipsum Dolor Sit Amet, Consectetur Adipiscing Elit.",
            "08:00 PM"
          );
          addMessage(
            "sent",
            "Lorem Ipsum Dolor Sit Amet, Consectetur Adipiscing Elit.",
            "08:00 PM",
            true
          );
        }
      }

      function addMessage(type, text, time, hasCheckmark = false) {
        const chatMessages = document.querySelector(".chat-messages");
        const messageDiv = document.createElement("div");
        messageDiv.className = `chat-message ${type}-message`;

        let messageHTML = `
                <p class="message-content">${text}</p>
                <div class="message-time">
                    ${time}
                    ${
                      hasCheckmark ? '<span class="message-status"></span>' : ""
                    }
                </div>
            `;

        messageDiv.innerHTML = messageHTML;
        chatMessages.appendChild(messageDiv);

        // Scroll to the bottom of the chat
        chatMessages.scrollTop = chatMessages.scrollHeight;
      }

      function sendMessage() {
        const messageInput = document.getElementById("messageInput");
        const messageText = messageInput.value.trim();

        if (messageText) {
          // Add the sent message to the chat
          addMessage("sent", messageText, getCurrentTime(), true);

          // Clear the input field
          messageInput.value = "";

          // Simulate a reply after a short delay
          setTimeout(() => {
            const activeContact = document.querySelector(
              ".contact.active .contact-name"
            ).textContent;
            addMessage(
              "received",
              `This is a response from ${activeContact}.`,
              getCurrentTime()
            );
          }, 1000);
        }
      }

      function handleKeyPress(event) {
        if (event.key === "Enter") {
          sendMessage();
        }
      }

      function getCurrentTime() {
        const now = new Date();
        let hours = now.getHours();
        const minutes = now.getMinutes().toString().padStart(2, "0");
        const ampm = hours >= 12 ? "PM" : "AM";

        hours = hours % 12;
        hours = hours ? hours : 12; // Convert 0 to 12

        return `${hours}:${minutes} ${ampm}`;
      }

      // Initialize the first contact as active when the page loads
      document.addEventListener("DOMContentLoaded", function () {
        // Set the first contact as active
        const firstContact = document.querySelector(".contacts-list .contact");
        if (firstContact) {
          setActiveContact(firstContact);
        }

        // Initialize section based on URL hash
        const hash = window.location.hash.substring(1);
        if (hash) {
          const section = document.getElementById(hash);
          if (section) {
            const navItem = document.querySelector(
              `.nav-item[data-section="${hash}"]`
            );
            if (navItem) {
              switchSection(navItem, hash);
            }
          }
        }

        // Fix scrolling behavior for notice list
        const noticeList = document.getElementById("noticeList");

        // Add wheel event listener to ensure scroll works when hovering over notices
        noticeList.addEventListener("wheel", function (e) {
          // Prevent the event from propagating to parent elements
          e.stopPropagation();

          // Calculate the new scroll position
          const scrollAmount = e.deltaY;
          noticeList.scrollTop += scrollAmount;

          // Prevent default only if we're at the top or bottom to allow page scrolling
          const isAtTop = noticeList.scrollTop === 0 && e.deltaY < 0;
          const isAtBottom =
            noticeList.scrollTop >=
              noticeList.scrollHeight - noticeList.clientHeight && e.deltaY > 0;

          if (!isAtTop && !isAtBottom) {
            e.preventDefault();
          }
        });
      });

      let notices = []; // Array to store all notices
      /*
      function toggleNoticeMode() {
        const noticeListView = document.getElementById("noticeListView");
        const noticeCreationView =
          document.getElementById("noticeCreationView");
        const noticeDetailView = document.getElementById("noticeDetailView");
        const noticeContent = document.getElementById("noticeContent");
        const noticeTitle = document.getElementById("noticeTitle");
        const noticeButton = document.getElementById("noticeButton");
        const noticeFilter = document.getElementById("noticeFilter");

        if (noticeButton.textContent === "CREATE NOTICE") {
          // Switch to creation mode
          noticeListView.style.display = "none";
          noticeCreationView.style.display = "block";
          noticeCreationView.style.height = "auto";
          noticeDetailView.style.display = "none";
          noticeFilter.style.display = "none"; // Hide filter in creation mode
          noticeContent.innerHTML = ""; // Clear the content area
          noticeTitle.value = ""; // Clear the title
          noticeContent.focus();
          noticeButton.textContent = "SEND NOTICE";
          noticeButton.classList.remove("create-notice-btn");
          noticeButton.classList.add("send-notice-btn");
        } else {
          // Save the notice and switch back to list view
          if (noticeContent.innerHTML.trim() !== "") {
            saveNotice(noticeTitle.value, noticeContent.innerHTML);
          }

          noticeListView.style.display = "block";
          noticeCreationView.style.display = "none";
          noticeDetailView.style.display = "none";
          noticeFilter.style.display = "block"; // Show filter in list mode
          noticeButton.textContent = "CREATE NOTICE";
          noticeButton.classList.remove("send-notice-btn");
          noticeButton.classList.add("create-notice-btn");
        }
      }*/
      function toggleNoticeMode() {
        const noticeListView = document.getElementById("noticeListView");
        const noticeCreationView =
          document.getElementById("noticeCreationView");
        const noticeDetailView = document.getElementById("noticeDetailView");
        const noticeContent = document.getElementById("noticeContent");
        const noticeTitle = document.getElementById("noticeTitle");
        const noticeButton = document.getElementById("noticeButton");
        const noticeFilter = document.getElementById("noticeFilter");

        if (noticeButton.textContent === "CREATE NOTICE") {
          noticeListView.style.display = "none";
          noticeCreationView.style.display = "block";
          noticeDetailView.style.display = "none";
          noticeFilter.style.display = "none";
          noticeContent.innerHTML = "";
          noticeTitle.value = "";
          noticeContent.focus();
          noticeButton.textContent = "SEND NOTICE";
          noticeButton.classList.replace(
            "create-notice-btn",
            "send-notice-btn"
          );
        } else {
          if (noticeContent.innerHTML.trim() !== "") {
            saveNotice(noticeTitle.value, noticeContent.innerHTML);
          }

          noticeListView.style.display = "block";
          noticeCreationView.style.display = "none";
          noticeDetailView.style.display = "none";
          noticeFilter.style.display = "block";
          noticeButton.textContent = "CREATE NOTICE";
          noticeButton.classList.replace(
            "send-notice-btn",
            "create-notice-btn"
          );
        }
      }
      /*
        function saveNotice(title, content) {
            const now = new Date();
            const formattedDate = `${now.toLocaleDateString()} ${now.toLocaleTimeString()}`;
            
            // Create a new notice object
            const notice = {
                id: Date.now(), // Unique ID based on timestamp
                date: formattedDate,
                content: content,
                title: title.trim() // Store the actual title (may be empty)
            };
            
            // Add to the notices array
            notices.unshift(notice); // Add to the beginning of the array
            
            // Update the UI
            updateNoticeList();
            
            // Here you would add code to send the notice to the parent page
            console.log('Notice saved:', notice);
        }*/
      async function saveNotice(title, content) {
        try {
          const response = await fetch("/create_notice", {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify({ title, content }),
          });

          const result = await response.json();

          if (result.success) {
            alert("Notice created successfully!");
            loadNotices(); // Refresh notices
          } else {
            alert("Failed to create notice. Please try again.");
          }
        } catch (error) {
          console.error("Error saving notice:", error);
          alert("Failed to connect to the server.");
        }
      }
      async function loadNotices() {
        try {
          const response = await fetch("/get_notices");
          const notices = await response.json();

          const noticeList = document.getElementById("noticeList");
          const emptyNoticeMessage =
            document.getElementById("emptyNoticeMessage");

          noticeList.innerHTML = ""; // Clear existing notices

          if (notices.length === 0) {
            emptyNoticeMessage.style.display = "block";
            return;
          }

          emptyNoticeMessage.style.display = "none";

          notices.forEach((notice) => {
            const noticeElement = document.createElement("div");
            noticeElement.className = "notice-container";
            noticeElement.dataset.id = notice.id;

            noticeElement.innerHTML = `
                <div class="notice-header">
                    <span>${notice.date}</span>
                </div>
                <div class="notice-title">${notice.title}</div>
                <div class="notice-preview">${notice.content.substring(
                  0,
                  100
                )}...</div>
            `;

            noticeElement.addEventListener("click", () =>
              showNoticeDetail(notice.id)
            );

            noticeList.appendChild(noticeElement);
          });
        } catch (error) {
          console.error("Error loading notices:", error);
          alert("Failed to fetch notices from the server.");
        }
      }

      // Load notices when the page loads
      window.onload = loadNotices;

      function getNoticeTitle(content) {
        // Extract first line or first few words as title
        const textContent = content.replace(/<[^>]*>/g, " ").trim();
        const words = textContent.split(" ");
        return words.slice(0, 5).join(" ") + (words.length > 5 ? "..." : "");
      }

      function updateNoticeList(filteredNotices = null) {
        const noticeList = document.getElementById("noticeList");
        const emptyMessage = document.getElementById("emptyNoticeMessage");
        const noticesToDisplay = filteredNotices || notices;

        // Clear the current list
        noticeList.innerHTML = "";

        if (noticesToDisplay.length === 0) {
          emptyMessage.style.display = "block";
          return;
        }

        emptyMessage.style.display = "none";

        // Add each notice to the list
        noticesToDisplay.forEach((notice) => {
          const noticeElement = document.createElement("div");
          noticeElement.className = "notice-container";
          noticeElement.dataset.id = notice.id;

          // Get clean text content without HTML tags
          const cleanContent = notice.content.replace(/<[^>]*>/g, " ").trim();

          // If there's no title, use content for title and leave preview empty
          const hasCustomTitle =
            notice.title !== getNoticeTitle(notice.content);
          const titleText = hasCustomTitle
            ? notice.title
            : cleanContent.substring(0, 100) +
              (cleanContent.length > 100 ? "..." : "");
          const previewText = hasCustomTitle
            ? cleanContent.substring(0, 100) +
              (cleanContent.length > 100 ? "..." : "")
            : "";

          noticeElement.innerHTML = `
                    <button class="delete-notice-btn" title="Delete notice">🗑️</button>
                    <div class="notice-header">
                        <span>${notice.date}</span>
                    </div>
                    <div class="notice-title">${titleText}</div>
                    ${
                      previewText
                        ? `<div class="notice-preview">${previewText}</div>`
                        : ""
                    }
                `;

          // Add click event for viewing the notice
          noticeElement.addEventListener("click", function (e) {
            // Don't show detail if delete button was clicked
            if (e.target.className !== "delete-notice-btn") {
              showNoticeDetail(notice.id);
            }
          });

          // Add delete button functionality
          const deleteBtn = noticeElement.querySelector(".delete-notice-btn");
          deleteBtn.addEventListener("click", function (e) {
            e.stopPropagation(); // Prevent triggering the container click
            deleteNotice(notice.id);
          });

          noticeList.appendChild(noticeElement);
        });
      }

      function deleteNotice(noticeId) {
        if (confirm("Are you sure you want to delete this notice?")) {
          notices = notices.filter((notice) => notice.id !== noticeId);
          updateNoticeList();
        }
      }

      function showNoticeDetail(noticeId) {
        const notice = notices.find((n) => n.id === noticeId);
        if (!notice) return;

        const noticeListView = document.getElementById("noticeListView");
        const noticeCreationView =
          document.getElementById("noticeCreationView");
        const noticeDetailView = document.getElementById("noticeDetailView");
        const noticeDetailTitle = document.getElementById("noticeDetailTitle");
        const noticeDetailDate = document.getElementById("noticeDetailDate");
        const noticeDetailContent = document.getElementById(
          "noticeDetailContent"
        );
        const noticeFilter = document.getElementById("noticeFilter");

        // Populate the detail view
        noticeDetailTitle.textContent = notice.title;
        noticeDetailDate.textContent = notice.date;
        noticeDetailContent.innerHTML = notice.content;

        // Show the detail view
        noticeListView.style.display = "none";
        noticeCreationView.style.display = "none";
        noticeDetailView.style.display = "block";
        noticeFilter.style.display = "none"; // Hide filter in detail view
      }

      function showNoticeList() {
        const noticeListView = document.getElementById("noticeListView");
        const noticeCreationView =
          document.getElementById("noticeCreationView");
        const noticeDetailView = document.getElementById("noticeDetailView");
        const noticeFilter = document.getElementById("noticeFilter");

        noticeListView.style.display = "block";
        noticeCreationView.style.display = "none";
        noticeDetailView.style.display = "none";
        noticeFilter.style.display = "block"; // Show filter in list view
      }

      // Add placeholder support for contenteditable
      document.addEventListener("DOMContentLoaded", function () {
        const noticeContent = document.getElementById("noticeContent");

        noticeContent.addEventListener("focus", function () {
          if (this.innerHTML.trim() === "") {
            this.innerHTML = "";
          }
        });

        noticeContent.addEventListener("blur", function () {
          if (this.innerHTML.trim() === "") {
            this.innerHTML = "";
          }
        });

        // Initialize the notice list
        updateNoticeList();
      });

      // Add this function to filter notices
      function filterNotices() {
        const filterValue = document.getElementById("noticeFilterSelect").value;
        const filteredNotices = filterNoticesByDate(filterValue);
        updateNoticeList(filteredNotices);
      }

      // Function to filter notices by date
      function filterNoticesByDate(filter) {
        if (filter === "all") {
          return notices;
        }

        const now = new Date();
        const today = new Date(
          now.getFullYear(),
          now.getMonth(),
          now.getDate()
        );
        const weekAgo = new Date(today);
        weekAgo.setDate(today.getDate() - 7);
        const monthAgo = new Date(today);
        monthAgo.setMonth(today.getMonth() - 1);

        return notices.filter((notice) => {
          const noticeDate = new Date(notice.date);

          switch (filter) {
            case "today":
              return noticeDate >= today;
            case "week":
              return noticeDate >= weekAgo;
            case "month":
              return noticeDate >= monthAgo;
            default:
              return true;
          }
        });
      }

      function showStudentReportDetail(classLevel) {
        // Hide the main student report view
        document.querySelector(".sticky-notes-container").style.display =
          "none";
        document.querySelector("#student-report h2").style.display = "none";

        // Show the detail view
        document.getElementById("student-report-detail").style.display =
          "block";

        // Show the student list view (intermediate page)
        document.getElementById("student-list-view").style.display = "block";

        // Hide the marks view
        document.getElementById("student-marks-view").style.display = "none";

        // You could customize the detail view based on the class level
        console.log(`Showing student list for ${classLevel}`);
      }

      function showStudentReportMain() {
        // Hide the detail view
        document.getElementById("student-report-detail").style.display = "none";

        // Show the main student report view
        document.querySelector(".sticky-notes-container").style.display =
          "flex";
        document.querySelector("#student-report h2").style.display = "block";
      }

      // Function to show the student marks detail view
      function showStudentMarksDetail(studentId, studentName) {
        // Hide the student list view
        document.getElementById("student-list-view").style.display = "none";

        // Show the marks view
        document.getElementById("student-marks-view").style.display = "block";

        // Update the student information
        document.getElementById("studentId").textContent = studentId;
        document.getElementById("studentName").textContent = studentName;

        console.log(`Showing marks for student: ${studentName} (${studentId})`);
      }

      // Function to go back to the student list view
      function showStudentListView() {
        // Hide the marks view
        document.getElementById("student-marks-view").style.display = "none";

        // Show the student list view
        document.getElementById("student-list-view").style.display = "block";
      }

      // Functions for the student list
      function addStudentRow() {
        const table = document.querySelector(".student-list-table");
        const newRow = table.insertRow(-1);

        // Create cells
        const idCell = newRow.insertCell(0);
        const nameCell = newRow.insertCell(1);

        // Generate a new student ID
        const lastRow = table.rows[table.rows.length - 2];
        const lastId = lastRow.cells[0].textContent;
        const newId =
          "STU" +
          (parseInt(lastId.substring(3)) + 1).toString().padStart(3, "0");

        // Set cell contents
        idCell.textContent = newId;
        nameCell.textContent = "New Student";

        // Add a new arrow for the new row
        const arrowContainer = document.querySelector(
          ".circle-arrow-container"
        );
        const newArrow = document.createElement("div");
        newArrow.className = "circle-arrow";
        newArrow.innerHTML = "→";

        // Position the new arrow based on the last arrow's position
        const existingArrows = document.querySelectorAll(".circle-arrow");
        if (existingArrows.length > 0) {
          const lastArrow = existingArrows[existingArrows.length - 1];
          const lastTop = parseInt(lastArrow.style.top);
          newArrow.style.top = lastTop + 41 + "px"; // 41px is the height of each row
        } else {
          newArrow.style.top = "58px"; // Starting position for the first arrow
        }

        // Set up the onclick handler for the new arrow
        newArrow.onclick = function () {
          showStudentMarksDetail(newId, "New Student");
        };

        // Add the new arrow to the container
        arrowContainer.appendChild(newArrow);

        // Scroll to the bottom if needed
        const tableContainer = document.querySelector(
          ".student-list-table-container"
        );
        tableContainer.scrollTop = tableContainer.scrollHeight;

        return newId;
      }

      function removeStudentRow() {
        const table = document.querySelector(".student-list-table");
        const rowCount = table.rows.length;

        // Don't remove if only header row and one data row remain
        if (rowCount <= 2) {
          return;
        }

        // Remove the last row
        table.deleteRow(rowCount - 1);

        // Remove the corresponding arrow
        const arrows = document.querySelectorAll(".circle-arrow");
        if (arrows.length > 0) {
          arrows[arrows.length - 1].remove();
        }
      }

      // Update student data without affecting the arrows
      function updateStudentData() {
        const table = document.querySelector(".student-list-table");
        const rows = table.querySelectorAll("tbody tr");
        const arrows = document.querySelectorAll(".circle-arrow");

        for (let i = 0; i < Math.min(rows.length, arrows.length); i++) {
          const row = rows[i];
          const arrow = arrows[i];

          const id = row.cells[0].textContent;
          const name = row.cells[1].textContent;

          arrow.onclick = function () {
            showStudentMarksDetail(id, name);
          };
        }
      }

      // Functions for the student list
      function addStudent() {
        const table = document.querySelector(".student-list-table");
        const newRow = table.insertRow(-1);

        // Create cells
        const idCell = newRow.insertCell(0);
        const nameCell = newRow.insertCell(1);

        // Generate a new student ID
        const lastRow = table.rows[table.rows.length - 2];
        const lastId = lastRow.cells[0].textContent;
        const newId =
          "STU" +
          (parseInt(lastId.substring(3)) + 1).toString().padStart(3, "0");

        // Set cell contents
        idCell.textContent = newId;
        nameCell.textContent = "New Student";

        // Add a new arrow for the new row
        const arrowContainer = document.querySelector(
          ".circle-arrow-container"
        );
        const newArrow = document.createElement("div");
        newArrow.className = "circle-arrow";
        newArrow.innerHTML = "→";

        // Position the new arrow based on the last arrow's position
        const existingArrows = document.querySelectorAll(".circle-arrow");
        if (existingArrows.length > 0) {
          const lastArrow = existingArrows[existingArrows.length - 1];
          const lastTop = parseInt(lastArrow.style.top);
          newArrow.style.top = lastTop + 41 + "px"; // 41px is the height of each row
        } else {
          newArrow.style.top = "58px"; // Starting position for the first arrow
        }

        // Set up the onclick handler for the new arrow
        newArrow.onclick = function () {
          showStudentMarksDetail(newId, "New Student");
        };

        // Add the new arrow to the container
        arrowContainer.appendChild(newArrow);

        // Scroll to the bottom if needed
        const tableContainer = document.querySelector(
          ".student-list-table-container"
        );
        tableContainer.scrollTop = tableContainer.scrollHeight;
      }

      function editStudent() {
        // Make all student table cells and headers editable
        const cells = document.querySelectorAll(
          ".student-list-table th, .student-list-table td"
        );
        cells.forEach((cell) => {
          cell.contentEditable = true;
          cell.style.backgroundColor = "#fff9c4"; // Highlight editable cells
        });
      }

      function saveStudentList() {
        // Save the edited student details and make cells non-editable
        const headerCells = document.querySelectorAll(".student-list-table th");
        headerCells.forEach((cell) => {
          cell.contentEditable = false;
          cell.style.backgroundColor = "#DB604D"; // Revert to original color
        });

        const rows = document.querySelectorAll(".student-list-table tbody tr");
        const arrows = document.querySelectorAll(".circle-arrow");

        // Process each row
        rows.forEach((row, rowIndex) => {
          const idCell = row.cells[0];
          const nameCell = row.cells[1];

          // Get updated values
          const id = idCell.textContent;
          const name = nameCell.textContent;

          // Make cells non-editable and revert background color
          idCell.contentEditable = false;
          nameCell.contentEditable = false;
          idCell.style.backgroundColor = "#DB604D";
          nameCell.style.backgroundColor = "#DB604D";

          // Find the corresponding arrow and update its onclick
          if (rowIndex < arrows.length) {
            arrows[rowIndex].onclick = function () {
              showStudentMarksDetail(id, name);
            };
          }
        });
      }

      // Functions for the marks table buttons
      function editMarks() {
        // Make the table cells editable
        const cells = document.querySelectorAll(".marks-table td");
        cells.forEach((cell) => {
          cell.contentEditable = true;
          cell.style.backgroundColor = "#fff9c4"; // Highlight editable cells
        });
      }

      function saveMarks() {
        // Save the edited marks and make cells non-editable
        const cells = document.querySelectorAll(".marks-table td");
        cells.forEach((cell) => {
          cell.contentEditable = false;
          cell.style.backgroundColor = "#DB604D"; // Revert to original color
        });
      }

      function uploadMarks() {
        // Show confirmation dialog
        if (confirm("Are you sure you want to upload the marks?")) {
          // Code to handle the upload
          console.log("Marks uploaded");
        }
      }

      // Table modification functions
      function addRow() {
        const table = document.querySelector(".marks-table");
        const rowCount = table.rows[0].cells.length;
        const newRow = table.insertRow(-1); // -1 appends at the end

        // Add cells to the new row
        for (let i = 0; i < rowCount; i++) {
          const cell = newRow.insertCell(i);
          cell.contentEditable = false;
          cell.style.backgroundColor = "#DB604D";
        }
      }

      function removeRow() {
        const table = document.querySelector(".marks-table");
        const rowCount = table.rows.length;

        // Don't remove header or the last data row
        if (rowCount <= 2) {
          alert("Cannot remove all rows.");
          return;
        }

        table.deleteRow(rowCount - 1); // Remove the last row
      }

      function addColumn() {
        const table = document.querySelector(".marks-table");
        const rows = table.rows;

        // Add header cell first
        const headerCell = document.createElement("th");
        headerCell.textContent = `Column ${rows[0].cells.length + 1}`;
        rows[0].appendChild(headerCell);

        // Add a cell to each data row
        for (let i = 1; i < rows.length; i++) {
          const cell = rows[i].insertCell(-1);
          cell.contentEditable = false;
          cell.style.backgroundColor = "#DB604D";
        }
      }

      function removeColumn() {
        const table = document.querySelector(".marks-table");
        const rows = table.rows;
        const columnCount = rows[0].cells.length;

        // Don't remove if only 2 columns remain (Subject and Marks)
        if (columnCount <= 2) {
          alert("Cannot remove all columns.");
          return;
        }

        // Remove the last cell from each row
        for (let i = 0; i < rows.length; i++) {
          rows[i].deleteCell(columnCount - 1);
        }
      }

      // Update event listeners for sticky notes
      document.addEventListener("DOMContentLoaded", function () {
        document.querySelectorAll(".sticky-note-button").forEach((button) => {
          button.addEventListener("click", function () {
            const classLevel = this.textContent.trim();
            showStudentReportDetail(classLevel);
          });
        });
      });

      // Update arrow handlers on page load
      document.addEventListener("DOMContentLoaded", function () {
        updateArrowHandlers();
      });

      // Update the onclick handlers for the arrow buttons
      function updateArrowHandlers() {
        const table = document.querySelector(".student-list-table");
        const rows = table.querySelectorAll("tbody tr");
        const arrows = document.querySelectorAll(".circle-arrow");

        // If there are no rows or no arrows, exit early
        if (!rows.length || !arrows.length) return;

        // Always show exactly 6 arrows for the last 6 rows (or fewer if there are fewer rows)
        const visibleRowCount = Math.min(rows.length, 6);
        const startRowIndex = Math.max(0, rows.length - visibleRowCount);

        // First hide all arrows
        arrows.forEach((arrow) => {
          arrow.style.display = "none";
        });

        // Then show only the arrows we need and update their handlers
        for (let i = 0; i < visibleRowCount; i++) {
          const arrowIndex = i;
          const rowIndex = startRowIndex + i;

          if (rowIndex < rows.length && arrowIndex < arrows.length) {
            const row = rows[rowIndex];
            const id = row.cells[0].textContent;
            const name = row.cells[1].textContent;

            // Update onclick handler
            arrows[arrowIndex].onclick = function () {
              showStudentMarksDetail(id, name);
            };

            // Show this arrow
            arrows[arrowIndex].style.display = "flex";
          }
        }
      }
    </script>
  </body>
</html>
